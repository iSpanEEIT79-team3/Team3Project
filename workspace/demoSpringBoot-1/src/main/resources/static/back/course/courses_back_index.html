<!DOCTYPE html>
<html>

<head>
    <meta name="description"
        content="Vali is a responsive and free admin theme built with Bootstrap 4, SASS and PUG.js. It's fully customizable and modular.">
    <title>JFSwing後台</title>
    <style>
        .table {
            white-space: nowrap;
            /* 不換行 */
        }

        thead {
            background-color: #EEBA7E;
            font-size: 22.5px;
        }

        th {
            border: 1px solid white;
        }

        td {
            border: 1px solid black;
            font-size: 16px;
        }
    </style>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="../css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body class="app sidebar-mini rtl pace-done">
    <main class="app-content">
        <div class="app-title">
            <h1>大標題</h1>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="tile">
                    <div class="tile-title">
                        <h2>課程資料</h2>
                    </div>
                    <div class="tile-body">
                        <table class="table"></table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Essential javascripts for application to work-->
    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <script src="../js/plugins/pace.min.js"></script>
    <!-- Page specific javascripts-->
    <script type="text/javascript" src="../js/plugins/chart.js"></script>
    <script type="text/javascript" src="../js/plugins/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="../js/plugins/dataTables.bootstrap.min.js"></script>
    <script>
        fetch('../exampleBack.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
            });

        function RWDTest() {
            let RWD = document.body;
            if (RWD.className === "app sidebar-mini rtl sidenav-toggled pace-done") {
                RWD.className = "app sidebar-mini rtl pace-done";
            } else {
                RWD.className = "app sidebar-mini rtl sidenav-toggled pace-done";
            }
        }

        $.ajax({
            url: '/GetAllCourses', // 更新此URL为你的课程API端点
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                console.log(data);
                $('.table').DataTable({
                    "autoWidth": true,
                    "scrollX": "1300px",
                    "scrollCollapse": true,
                    "language": {
                        "processing": "處理中...",
                        "loadingRecords": "載入中...",
                        "lengthMenu": "顯示 _MENU_ 項結果",
                        "zeroRecords": "沒有符合的結果",
                        "info": "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                        "infoEmpty": "顯示第 0 至 0 項結果，共 0 項",
                        "infoFiltered": "(從 _MAX_ 項結果中過濾)",
                        "search": "搜尋:",
                        "paginate": {
                            "first": "第一頁",
                            "previous": "上一頁",
                            "next": "下一頁",
                            "last": "最後一頁"
                        },
                        "aria": {
                            "sortAscending": ": 升冪排列",
                            "sortDescending": ": 降冪排列"
                        }
                    },
                    "data": data,
                    "columns": [
                        { data: 'idUser', title: "用戶ID" },
                        { data: 'productId', title: "產品ID", render: function (data, type, row) {
                            return '<a href="/courseDetails/' + data + '">' + data + '</a>';
                        }},
                        { data: 'courseName', title: "課程名稱" },
                        { data: 'description', title: "描述" },
                        { data: 'courseType', title: "課程類型" },
                        { data: 'startDate', title: "開始日期" },
                        { data: 'endDate', title: "結束日期" },
                        { data: 'deadlineDate', title: "截止日期" },
                        { data: 'location', title: "地點" },
                        { data: 'price', title: "價格" },
                        { data: 'teacherName', title: "教師名稱" },
                        { data: 'teacherContact', title: "教師聯繫方式" },
                        { data: 'enrollmentCount', title: "報名人數" },
                        { data: 'maxCapacity', title: "最大容量" },
                        { data: 'courseImage', title: "課程圖片", render: function (data, type, row) {
                            return '<img src="' + data + '" style="width: 100px; height: 100px;">';
                        }},
                        { title: "修改", render: function (data, type, row) {
                            return '<a href="/GetCourseById/' + row.productId + '"><button class="btn btn-primary" type="button">修改</button></a>';
                        }},
                        { title: "刪除", render: function (data, type, row) {
                            return '<form method="post" action="/DeleteById?courseID=' + row.productId + '">' +
                                   '<input type="hidden" name="_method" value="DELETE">' +
                                   '<button class="btn btn-primary" type="submit">刪除</button>' +
                                   '</form>';
                        }}
                    ]
                });
            },
            error: function (xhr, status, error) {
                console.error(status, error);
                alert('錯誤！');
            }
        });
    </script>
</body>

</html>
