<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>會員管理</title>
    <link href="https://cdn.datatables.net/v/dt/dt-2.0.1/datatables.min.css" rel="stylesheet">

    <style>
        .serach input {
            width: 450px;
            height: 30px;
            font-size: 22px;
            border-radius: 5px;
        }

        .serachButton {
            border-radius: 5px;
        }

        .table {
            white-space: nowrap;
            /* 不換行 */
        }


        th {
            border: 1px solid black;
            font-size: 25px;
        }

        td {
            border: 1px solid black;
            font-size: 21px;
        }

        .circle {
            border-radius: 15px;
            width: 70px;
            font-size: 20px;
            transition: background-color 0.3s ease;
        }


        .circle:hover {
            background-color: #7AFEC6;
            transform: scale(1.2);
        }
    </style>
</head>

<body>
    <div class="frontPage"></div>

    <div class="center">
        <h2>會員管理</h2>

        <table class="table"></table>

    </div>

    <div class="footPage"></div>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/v/dt/dt-2.0.1/datatables.min.js"></script>
    <script>
        $(function () {
            $('.dt-empty').remove;


            $.ajax({
                url: '/GetAllUser', // 替换为您的 API 端点
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    $('.table').DataTable({
                        "autoWidth": true,
                        "scrollX": "1300px",
                        "scrollY": "800px",
                        "scrollCollapse": true,
                        "language": {
                            "processing": "處理中...",
                            "loadingRecords": "載入中...",
                            "lengthMenu": "顯示 _MENU_ 項結果",
                            "zeroRecords": "沒有符合的結果",
                            "info": "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                            "infoEmpty": "顯示第 0 至 0 項結果，共 0 項",
                            "infoFiltered": "(從 _MAX_ 項結果中過濾)",
                            "infoPostFix": "",
                            "search": "搜尋:",
                            "paginate": {
                                "first": "第一頁",
                                "previous": "上一頁",
                                "next": "下一頁",
                                "last": "最後一頁"
                            },

                            "aria": {
                                "sortAscending": ": 升冪排列",
                                "sortDescending": ": 降冪排列"
                            }
                        },
                        "data": data,
                        "columns": [{
                            data: 'userId',
                            title: "編號"
                        },
                        {
                            data: "userContact.name",
                            title: "姓名"
                        },
                        {
                            data: 'nickName',
                            title: "暱稱"
                        },
                        {
                            data: 'gender',
                            title: "姓別"
                        },
                        {
                            data: 'userContact.email',
                            title: "信箱"
                        },
                        {
                            data: 'password',
                            title: "密碼"
                        },
                        {
                            data: 'birthday',
                            title: "出生年月日"
                        },
                        {
                            data: 'userContact.phone',
                            title: "電話"
                        },
                        {
                            data: 'userContact.address',
                            title: "地址"
                        },
                        {
                            data: 'danceCharacter',
                            title: "跳舞角色"
                        },
                        {
                            data: 'danceAge',
                            title: "舞齡"
                        },
                        {
                            title: "照片",
                            render: function (data, type, row, meta) {
                                return '<td><a href="' + row.picture +
                                    '">圖片</a></td>';
                            }
                        },
                        {
                            title: "修改",
                            render: function (data, type, row, meta) {
                                return '<form method="get" action="/UpdateUser/' +
                                    row.userId + '">' +
                                    '<button class="circle" type="submit">修改</button>' +
                                    '</form>';
                            }
                        },
                        {
                            title: "刪除",
                            render: function (data, type, row, meta) {
                                return '<form method="post" action="/DeleteUser?idUser=' +
                                    row.userId + '">' +
                                    '<input type="hidden" name="_method" value="DELETE">' +
                                    ' <button class="circle" type="submit">刪除</button>' +
                                    ' </form>';
                            }
                        }
                        ]
                    });
                },
                error: function (xhr, status, error) {
                    console.error(status, error);
                    alert('錯誤！');
                }
            });

            fetch('/back')
                .then(response => response.text())
                .then(html => {
                    //內容
                    $('.frontPage').html(html);
                })
                .catch(error => console.error('Error fetching back.html', error));

            fetch('/back2')
                .then(response => response.text())
                .then(html => {
                    //內容
                    $('.footPage').html(html);
                })
                .catch(error => console.error('Error fetching back.html', error));

        });
    </script>
</body>

</html>