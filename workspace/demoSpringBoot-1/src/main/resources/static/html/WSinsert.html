<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Get Event data</title>
	<script>
		function upload() {
			var form = document.getElementById('myForm');
			var formData = new FormData(form);
			fetch('/WSinsert', {
				method: 'POST',
				body: formData
			})
				.then(
					function (response) {
						if (response.status != 200) {
							console.log('response status1:' + response.status);
							return;

						} console.log('response status2:' + response.status);
						window.location.href = "/WSall";
					}

				)

		}

	</script>
</head>

<body>
	<h2>活動資訊</h2>
	<form method="post" action="/WSinsert" id="myForm" enctype="multipart/form-data">

		輸入活動名稱 : <input type="text" id="EVENT_NAME" name="EVENT_NAME" /><br><br>
		報名開始日期 : <input type="date" id="SIGNUP_STARTIME" name="SIGNUP_STARTIME" /><br><br>
		報名結束日期 : <input type="date" id="SIGNUP_ENDTIME" name="SIGNUP_ENDTIME" /><br><br>
		活動開始時間 : <input type="date" id="EVENT_STARTIME" name="EVENT_STARTIME" /><br><br>
		活動結束時間 : <input type="date" id="EVENT_ENDTIME" name="EVENT_ENDTIME" /><br><br>
		活動詳細資料 : <input type="text" id="EVENT_DETAIL" name="EVENT_DETAIL" /><br><br>
		活動種類 : <input type="text" id="EVENT_CATEGORY" name="EVENT_CATEGORY" /><br><br>
		報名金額 : <input type="text" id="EVENT_PRICE" name="EVENT_PRICE" /><br><br>
		活動地址 : <input type="text" id="EVENT_ADDRES" name="EVENT_ADDRES" /><br><br>
		組織者 : <input type="text" id="ORGANIZER" name="ORGANIZER" /><br><br>
		圖片 : <input type="file" id="PICTURE" name="PICTURE" /><br><br>
		<button type="button" onclick="upload()">確定</button>
		
		 <input type="file" name="files" id="fileInput" multiple accept="image/*" onchange="previewImages(event)" style="display: none;">
        <label for="fileInput">選擇圖片</label>
        <div id="imagePreview"></div>
        <button type="button" onclick="uploadAndSubmit()">上傳並提交</button>
	</form>
	
<div id="onLoadImage">

</div>


</body>

<script>
        function chooseFiles() {
            document.getElementById('fileInput').click();
        }

        function previewImages(event) {
            var preview = document.getElementById('imagePreview');
            preview.innerHTML = '';
            var files = event.target.files;

            for (var i = 0; i < files.length; i++) {
                var file = files[i];
                var reader = new FileReader();

                reader.onload = function (event) {
                    var img = document.createElement('img');
                    img.src = event.target.result;
                    img.style.width = '100px'; // 設置圖片寬度
                    img.style.height = 'auto'; // 根據寬度自動調整高度
                    preview.appendChild(img);
                }

                reader.readAsDataURL(file);
            }
        }

        function uploadAndSubmit() {
            var formData = new FormData();
            var fileInput = document.getElementById('fileInput');
            var files = fileInput.files;

            for (var i = 0; i < files.length; i++) {
                formData.append('files', files[i]);
            }

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    console.log('文件上傳成功');
                    // 文件上傳成功後，提交表單
                    document.getElementById('myForm').submit();
                } else {
                    console.log('文件上傳失敗');
                }
            })
            .catch(error => console.error('文件上傳出錯:', error));
        }
    </script>






</html>